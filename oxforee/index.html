<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Oxford 3000 Master</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Inter:wght@400;600;700&family=Sarabun:wght@300;400;500;600&display=swap"
    rel="stylesheet">
</head>

<body>
  <div class="app">

    <!-- HEADER -->
    <header class="header" id="mainHeader">
      <div class="logo">
        <div class="logo-icon">O</div>
        <div class="logo-text">
          <h1>Oxford 3000</h1>
          <span>Master Vocabulary</span>
        </div>
      </div>
      <div class="user-actions">
        <div class="streak-pill">üî• <span id="streakCount">12</span></div>
        <button class="sound-btn"
          onclick="if(confirm('Reset all progress?')){APP.state.progress={};APP.saveProgress();APP.applyFilters();}">‚Ü∫</button>
      </div>
    </header>

    <!-- NAVIGATION TABS -->
    <div class="nav-tab-container">
      <button class="nav-tab-btn active" id="tabVocab" onclick="switchPage('vocab')">üìö ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</button>
      <button class="nav-tab-btn" id="tabInfor" onclick="switchPage('infor')">üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</button>
    </div>

    <!-- ==================== PAGE: VOCABULARY ==================== -->
    <div id="vocab" class="page-content active">

      <!-- DAILY GOAL CARD -->
      <div class="daily-goal-card">
        <div class="daily-content">
          <div class="daily-title">Daily Progress</div>
          <div class="daily-val">
            <span id="masteredCount">0</span>
            <span style="font-size:16px; opacity:0.7;">/ <span id="totalCount">3000</span> Words</span>
          </div>
          <div class="progress-container">
            <div class="progress-fill" id="mainProgressFill" style="width: 0%"></div>
          </div>
          <div style="margin-top:12px; font-size:13px; font-weight:600; text-align:right; opacity:0.9;">Keep going! üöÄ
          </div>
        </div>
      </div>

      <!-- MINI STATS GRID -->
      <div class="stats-grid">
        <div class="mini-stat" onclick="APP.startFlashcards()" style="cursor:pointer;">
          <div class="mini-icon ms-orange">‚ö°</div>
          <div>
            <div style="font-size:11px; font-weight:700; color:#94A3B8; text-transform:uppercase;">To Review</div>
            <div style="font-size:20px; font-weight:800; color:#0F172A;" id="reviewCount">0</div>
          </div>
          <div style="margin-left:auto; color:#EA580C; font-size:20px;">‚Ä∫</div>
        </div>
        <div class="mini-stat" onclick="APP.startQuiz()" style="cursor:pointer;">
          <div class="mini-icon ms-green">üéÆ</div>
          <div>
            <div style="font-size:11px; font-weight:700; color:#94A3B8; text-transform:uppercase;">Quiz</div>
            <div style="font-size:20px; font-weight:800; color:#0F172A;">Play</div>
          </div>
          <div style="margin-left:auto; color:#16A34A; font-size:20px;">‚Ä∫</div>
        </div>
      </div>

      <!-- SEARCH -->
      <div class="search-container">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" id="searchInput" placeholder="Search for a word..."
          oninput="APP.applyFilters()">
      </div>

      <!-- FILTERS -->
      <div class="filters-row">
        <button class="filter-chip chip-must-know" id="filter-core" onclick="APP.toggleLevel('CORE')">‚≠ê Must
          Know</button>
        <button class="filter-chip active" id="filter-all" onclick="APP.toggleLetter('ALL')">All</button>
      </div>
      <div class="filters-row" id="alphabetRow">
        <!-- A-Z -->
      </div>

      <!-- LIST -->
      <div id="vocabList" class="vocab-list"></div>

      <!-- EMPTY STATE -->
      <div id="emptyState" class="empty-state hidden">
        <div class="empty-icon">üçÉ</div>
        <p>No words found.</p>
        <button onclick="APP.clearFilters()"
          style="margin-top:10px; color:#2563EB; font-weight:600; background:none; border:none; cursor:pointer;">Clear
          Filters</button>
      </div>
    </div>

    <!-- ==================== PAGE: ENCYCLOPEDIA ==================== -->
    <div id="infor" class="page-content">
      <div style="text-align:center; padding:60px 20px; color:#94A3B8;">
        <div style="font-size:48px; margin-bottom:12px;">üìñ</div>
        <p>Loading Encyclopedia...</p>
      </div>
    </div>
  </div>

  <!-- ==================== MODALS ==================== -->

  <!-- DETAIL MODAL -->
  <div class="modal" id="detailModal" onclick="if(event.target === this) this.classList.remove('active')">
    <div class="modal-content">
      <button class="close-btn" onclick="document.getElementById('detailModal').classList.remove('active')">√ó</button>
      <div class="modal-header">
        <h2 class="modal-word" id="modalWord">...</h2>
        <div class="modal-meta">
          <span class="pos-tag" id="modalPos">N.</span>
          <span class="lvl-badge lvl-A1" id="modalLevel">A1</span>
        </div>
      </div>
      <div class="modal-body">
        <div class="def-section">
          <div class="def-label">Meaning (Thai)</div>
          <div class="def-text" id="modalTrans">...</div>
        </div>
        <div class="def-section" id="modalDefSection" style="display:none;">
          <div class="def-label">Definitions (Eng)</div>
          <div class="def-text" id="modalMeanings">...</div>
        </div>
        <div class="def-section">
          <div class="def-label">Example</div>
          <div class="def-text" id="modalEx" style="font-style:italic; color:#64748b;">...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FLASHCARD MODAL -->
  <div class="modal" id="flashcardModal" onclick="if(event.target === this) this.classList.remove('active')">
    <div class="modal-content" style="text-align:center; padding: 32px;">
      <button class="close-btn"
        onclick="document.getElementById('flashcardModal').classList.remove('active')">√ó</button>
      <div style="font-size:12px; color:#94a3b8; margin-bottom:16px; text-transform:uppercase;">Review Mode</div>
      <div id="fcCard"
        style="background:#F8FAFC; border-radius:16px; padding:32px; min-height:200px; display:flex; align-items:center; justify-content:center; margin-bottom:24px; cursor:pointer;">
        <h2 style="font-size:28px;">Flashcard</h2>
      </div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <button onclick="APP.handleFlashcard(false)"
          style="background:#FEE2E2; color:#991B1B; padding:12px; border-radius:12px; font-weight:700; border:none; cursor:pointer;">Forgot</button>
        <button onclick="APP.handleFlashcard(true)"
          style="background:#DCFCE7; color:#166534; padding:12px; border-radius:12px; font-weight:700; border:none; cursor:pointer;">Remember</button>
      </div>
    </div>
  </div>

  <!-- QUIZ MODAL -->
  <div class="modal" id="quizModal" onclick="if(event.target === this) this.classList.remove('active')">
    <div class="modal-content">
      <button class="close-btn" onclick="document.getElementById('quizModal').classList.remove('active')">√ó</button>
      <div style="text-align:center; margin-bottom:20px;">
        <span class="lvl-badge" style="background:#4F46E5; color:white;">QUIZ</span>
      </div>
      <div id="quizQuestion"
        style="font-size:20px; font-weight:700; margin-bottom:20px; text-align:center; font-family:'Sarabun', sans-serif;">
        ...</div>
      <div id="quizOptions" style="display:grid; gap:10px;"></div>
    </div>
  </div>

  <!-- ==================== SCRIPTS ==================== -->
  <script src="data.js"></script>
  <script src="script.js"></script>
  <script>
    // Page Switching
    async function switchPage(page) {
      document.getElementById('vocab').classList.remove('active');
      document.getElementById('infor').classList.remove('active');
      document.getElementById(page).classList.add('active');

      document.getElementById('tabVocab').classList.toggle('active', page === 'vocab');
      document.getElementById('tabInfor').classList.toggle('active', page === 'infor');

      // Lazy load encyclopedia
      if (page === 'infor' && !window.inforLoaded) {
        try {
          const res = await fetch('infor.html');
          const html = await res.text();
          const doc = new DOMParser().parseFromString(html, 'text/html');
          document.getElementById('infor').innerHTML = doc.body.innerHTML;

          // Execute scripts from infor.html
          doc.body.querySelectorAll('script').forEach(old => {
            const s = document.createElement('script');
            s.textContent = old.textContent;
            document.body.appendChild(s);
          });
          window.inforLoaded = true;
        } catch (err) {
          console.error('Failed to load encyclopedia:', err);
        }
      }
    }
  </script>
</body>

</html>